---
parameters:
  - name: serviceConnection
    type: string
  - name: whatIfEnabled
    type: boolean
    default: true

steps:
  - template: bicep-deploy.yaml
    parameters:
      serviceConnection: $${{ parameters.serviceConnection }}
      whatIfEnabled: $${{ parameters.whatIfEnabled }}
      scriptFiles:
%{ for script_file in script_files ~}
        - displayName: "${script_file.displayName}"
          templateFilePath: "${script_file.templateFilePath}"
          templateParametersFilePath: "${script_file.templateParametersFilePath}"
          managementGroupId: "${try("$(${script_file.managementGroupId})", "")}"
          subscriptionId: "${try("$(${script_file.subscriptionId})", "")}"
          resourceGroupName: "${try("$(${script_file.resourceGroupName})", "")}"
          location: "$(LOCATION)"
          deploymentType: "${script_file.deploymentType}"

%{ endfor ~}
